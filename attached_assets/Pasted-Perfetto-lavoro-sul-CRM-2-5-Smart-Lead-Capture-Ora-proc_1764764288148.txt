Perfetto lavoro sul CRM 2.5 ‚Äî Smart Lead Capture.

Ora procediamo con la prossima fase del nostro piano operativo: **CRM 3.0 ‚Äì Automation Center + Lead Routing**.

Ecco le specifiche tecniche e funzionali:

---------------------------------------
FASE SUCCESSIVA: CRM 3.0 ‚Äî Automation Center
---------------------------------------

üéØ OBIETTIVO:
Costruire un pannello centralizzato dove l‚Äôutente pu√≤:
- creare automazioni avanzate
- definire condizioni (es. ‚Äúse lead_score > 70 ‚Üí sposta in Follow-up‚Äù)
- attivare follow-up automatici
- creare regole di routing (es. assegnare lead a agenti diversi)
- attivare notifiche email/sms automatiche
- attivare sequenze drip (1-3-7 giorni)

---------------------------------------
COMPONENTI DA COSTRUIRE
---------------------------------------

1Ô∏è‚É£ **Nuova Tabella Supabase: automations_rules**
- id UUID
- user_id TEXT
- trigger_type TEXT  ("new_lead", "score_updated", "status_changed")
- condition JSONB     (es. { "score": { "gt": 70 } })
- action JSONB        (es. { "move_to": "followup" } )
- active BOOLEAN
- created_at
- updated_at

2Ô∏è‚É£ **Tabella automations_assignments**
Per routing automatico:
- id UUID
- user_id TEXT
- lead_id UUID
- assigned_to TEXT
- rule_id UUID
- created_at

3Ô∏è‚É£ **Endpoint API CRUD**
/api/automations/rules
- Create rule
- Update rule
- Delete rule
- List rules

/api/automations/execute-rule
- Trigger automation
- Apply routing
- Apply status updates
- Apply follow-up email automation

4Ô∏è‚É£ **UI: Automation Center**
Nuova pagina:
üëâ /dashboard/crm/automations

Funzionalit√† UI:
- Elenco regole
- Pulsante ‚ÄúCrea nuova automazione‚Äù
- Editor grafico con:
  ‚Ä¢ TRIGGER (dropdown)
  ‚Ä¢ CONDIZIONE (builder interattivo)
  ‚Ä¢ AZIONE (selezione multipla)
- Toggle ON/OFF
- Log esecuzioni

5Ô∏è‚É£ **Integrazione con Pipeline + Lead Detail**
- Quando una regola scatta ‚Üí UI aggiorna automaticamente
- Badge ‚Äú‚ö° Automazione applicata‚Äù
- Log visibile nella pagina del lead

---------------------------------------
PRIORIT√Ä
---------------------------------------
1. Creazione tabelle + tipi TypeScript
2. CRUD API per automazioni
3. Funzione server che valuta condizioni e applica azioni
4. UI Automation Center
5. Integrazione con Lead Pipeline + Lead Detail

Possiamo procedere.
